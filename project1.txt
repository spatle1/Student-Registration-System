Name: Sumeet Patle
email: spatle1@binghamtion.edu
================================================================================================================================================================================================================================================




SQL> start query1
SQL> select concat(c1.dept_code,c1.course#) as course_id, title from Courses c1 join Classes c2 on (c1.dept_code=c2.dept_code and c1.course#=c2.course#) where semester='Spring' and year=2021;

COURSE_ID                                    TITLE                              
-------------------------------------------- --------------------               
CS432                                        database systems                   
CS532                                        database systems                   

SQL> start query2
SQL> select lastname from students where sid in (select sid from enrollments e join Classes c on e.classid=c.classid where dept_code='CS' intersect select sid from enrollments e join Classes c on e.classid=c.classid where dept_code='Math');

LASTNAME                                                                        
---------------                                                                 
Broder                                                                          
Buttler                                                                         

SQL> start query3
SQL> select distinct dept_code, course# from Classes where year !='2022';

DEPT    COURSE#                                                                 
---- ----------                                                                 
CS          532                                                                 
CS          240                                                                 
CS          432                                                                 

SQL> start query4
SQL> select students.sid, lastname, gpa from students, enrollments where status != 'graduate' and lgrade='B' and students.sid=enrollments.sid;

SID  LASTNAME               GPA                                                 
---- --------------- ----------                                                 
B002 Buttler                3.7                                                 
B004 Callan                 2.5                                                 
B001 Broder                 3.6                                                 
B001 Broder                 3.6                                                 
B001 Broder                 3.6                                                 

SQL> start query5
SQL> select distinct s.firstname from Students s join Enrollments e on s.sid=e.sid where s.sid not in (select sid from Enrollments where lgrade='C');

FIRSTNAME                                                                       
---------------                                                                 
Terry                                                                           
Tracy                                                                           
Jack                                                                            
Becky                                                                           

SQL> start query6
SQL> select sid, lastname from Students where sid in (select sid from Enrollments group by sid having min(lgrade) = max(lgrade) and min(lgrade) = 'A');

SID  LASTNAME                                                                   
---- ---------------                                                            
B003 Wang                                                                       
B006 Zillman                                                                    
B007 Lee                                                                        

SQL> start query7
SQL> select distinct dept_code, course# from Classes where course# in (select course# from Classes group by course# having count(*)=(Select max(count(course#)) from Classes group by Course#));

DEPT    COURSE#                                                                 
---- ----------                                                                 
Math        314                                                                 
CS          432                                                                 

SQL> start query8
SQL> select classid, dept_code, course#, limit-class_size as seats_available from classes where class_size < limit and semester='Spring' and year='2022';

CLASS DEPT    COURSE# SEATS_AVAILABLE                                           
----- ---- ---------- ---------------                                           
c0001 CS          432               1                                           
c0002 Math        314               1                                           
c0003 Math        314               3                                           

SQL> start query9
SQL> select sid, firstname||' '||lastname as fullname from students where sid in (select sid from Enrollments group by sid having count(*)>3);

SID  FULLNAME                                                                   
---- -------------------------------                                            
B001 Anne Broder                                                                

SQL> start query10
SQL> select c.classid,c.dept_code,c.course#,c.sect#,c.year,c.semester,c.limit,c.class_size from Classes c left	join (select classid from Enrollments group by classid having count(sid)<3) e on c.classid=e.classid where semester='Spring' and year=2022 and dept_code='CS';

CLASS DEPT    COURSE#      SECT#       YEAR SEMEST      LIMIT CLASS_SIZE        
----- ---- ---------- ---------- ---------- ------ ---------- ----------        
c0001 CS          432          1       2022 Spring         35         34        

SQL> start query11
SQL> select sid, firstname from Students where sid in (select sid from Enrollments where classid in (select classid from Classes where dept_code='Math' and course# between 300 and 399));

SID  FIRSTNAME                                                                  
---- ---------------                                                            
B001 Anne                                                                       
B002 Terry                                                                      

SQL> start query12
SQL> (select title from courses c, enrollments e, classes cc where c.dept_code=cc.dept_code and c.course#=cc.course# and cc.classid=e.classid and e.sid='B003') minus (select title from courses c, enrollments e, classes cc where c.dept_code=cc.dept_code and c.course#=cc.course# and cc.classid=e.classid and e.sid='B005');

TITLE                                                                           
--------------------                                                            
data structure                                                                  

SQL> start query13
SQL> select firstname||' '||lastname as fullname from Students where sid in (select sid from Enrollments where classid in (select classid from Classes where course# in (select course# from Classes where classid in (select classid from Enrollments where sid='B005'))));

FULLNAME                                                                        
-------------------------------                                                 
Anne Broder                                                                     
Jack Smith                                                                      
Terry Zillman                                                                   

SQL> start query14
SQL> select c1.dept_code, c1.course#,c1.semester,c1.year from classes c1 inner join classes c2 on c1.semester=c2.semester and c1.year=c2.year group by c1.dept_code, c1.course#, c1.semester, c1.year having count(*)>4;

DEPT    COURSE# SEMEST       YEAR                                               
---- ---------- ------ ----------                                               
Math        314 Spring       2022                                               

SQL> start query15
SQL> select sid, firstname from Students where sid in (select e1.sid from Enrollments e1 inner join (select e.classid,min(e.lgrade) as Key from Enrollments e join Grades g on e.lgrade=g.lgrade group by e.classid) e2 on e1.classid=e2.classid and e1.lgrade=e2.key);

SID  FIRSTNAME                                                                  
---- ---------------                                                            
B001 Anne                                                                       
B002 Terry                                                                      
B003 Tracy                                                                      
B004 Barbara                                                                    
B006 Terry                                                                      
B007 Becky                                                                      

6 rows selected.

SQL> start query16
SQL> select c1.dept_code, c1.course#, title , nvl(lgrade,'to be assigned') grade from Courses c1 join (select c.dept_code,c.course#,lgrade from Classes c join (select classid, lgrade from enrollments where sid='B003') e on e.classid=c.classid) c2 on c1.dept_code=c2.dept_code and c1.course#=c2.course#;

DEPT    COURSE# TITLE                GRADE                                      
---- ---------- -------------------- --------------                             
CS          432 database systems     A                                          
CS          240 data structure       to be assigned                             

SQL> start query17
SQL> select c1.dept_code, c1.course#, cc.title from Classes c1 join Courses cc on c1.course#=cc.course# where c1.classid in (select c.classid from Classes c join Enrollments e on c.classid=e.classid where course# in (select course# from Courses where title like '%data%'));

DEPT    COURSE# TITLE                                                           
---- ---------- --------------------                                            
CS          432 database systems                                                
CS          432 database systems                                                
CS          240 data structure                                                  
CS          532 database systems                                                

SQL> start query18
SQL> select s.sid, lastname, nvl(sum(g.ngrade),0) as "Total number of credits" from Students s left join Enrollments e on s.sid=e.sid left join grades g on e.lgrade=g.lgrade group by s.sid,lastname;

SID  LASTNAME        Total number of credits                                    
---- --------------- -----------------------                                    
B005 Smith                                 3                                    
B002 Buttler                               7                                    
B007 Lee                                   4                                    
B003 Wang                                  4                                    
B001 Broder                               15                                    
B008 Baker                                 0                                    
B004 Callan                                5                                    
B006 Zillman                               4                                    

8 rows selected.

SQL> start query19
SQL> select avg(ngrade) as Average from Enrollments e join Grades g on e.lgrade=g.lgrade;

   AVERAGE                                                                      
----------                                                                      
3.23076923                                                                      

SQL> start query20
SQL>  select s.sid, nvl(m.cgpan,null) cgpa from students s left outer join (Select e.sid,sum(ngrade)/count(classid) as cgpan from Enrollments e join Grades g on e.lgrade=g.lgrade group by e.sid) m on s.sid=m.sid order by cgpa asc nulls last;

SID        CGPA                                                                 
---- ----------                                                                 
B004        2.5                                                                 
B005          3                                                                 
B001          3                                                                 
B002        3.5                                                                 
B007          4                                                                 
B006          4                                                                 
B003          4                                                                 
B008                                                                            

8 rows selected.

SQL> spool off
